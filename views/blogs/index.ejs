<html lang="en">
<%- include("../partials/head.ejs") %>

  <body>
    <%- include("../partials/nav.ejs") %>

      <div class="blogs content">
        <h2>All Games</h2>

        <% if (blogs.length> 0) { %>
          <% blogs.forEach(blog=> { %>
            <div class="single">
              <a href="/blogs/<%= blog._id %> ">
                <h3 class="title">
                  <%= blog.title %>
                </h3>
                <img src="<%= blog.img %> " alt="<%= blog.title %>" width="75px">
              </a>
              <p class="snippet">
                <%= blog.snippet %>
              </p>
              <p>MP : <span>
                  <%= blog.multiplayer %>
                </span> </p>
              <p><span>
                  <%= blog.console %>
                </span> </p>
              <a class="delete btn btn-danger" data-doc="<%= blog._id %>">delete</a>
            </div>

            <% }) %>
              <% } else { %>
                <p>There are no blogs to display...</p>
                <% } %>

      </div>

      <%- include("../partials/footer.ejs") %>
      <script>
        const trashcan = document.querySelector('a.delete');
        trashcan.addEventListener('click', (e) => {
            const endpoint = `/blogs/${trashcan.dataset.doc}`;
            fetch(endpoint, {
                method: 'DELETE',
            })
                .then(response => response.json())
                .then(data => window.location.href = data.redirect)
                .catch(err => console.log(err));
        });
    
    </script>
  </body>

</html>